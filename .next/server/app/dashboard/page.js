(()=>{var e={};e.id=105,e.ids=[105],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},5447:(e,r,t)=>{Promise.resolve().then(t.bind(t,43610))},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13139:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"40130881d44301a0cb5074ef0aa935e61ed883fe96":()=>n.H});var n=t(84148)},17478:(e,r)=>{"use strict";function t(e){for(let r=0;r<e.length;r++){let t=e[r];if("function"!=typeof t)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof t}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(r,"D",{enumerable:!0,get:function(){return t}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},43610:(e,r,t)=>{"use strict";t.d(r,{DashboardClient:()=>n});let n=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call DashboardClient() from the server but DashboardClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/app/src/components/dashboard-client.tsx","DashboardClient")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},57975:e=>{"use strict";e.exports=require("node:util")},60402:(e,r,t)=>{"use strict";t.a(e,async(e,n)=>{try{t.r(r),t.d(r,{"00d8e6fe7777699f20f80b3c37ed40207ea4ac6faa":()=>s.default});var s=t(80559),i=e([s]);s=(i.then?(await i)():i)[0],n()}catch(e){n(e)}})},61238:(e,r,t)=>{"use strict";t.d(r,{DashboardClient:()=>y});var n=t(60687),s=t(43210),i=t(29523),a=t(44493),o=t(89667),l=t(80013),c=t(52581),d=t(62688);let u=(0,d.A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var p=t(85814),f=t.n(p),m=t(96834);let h=(0,d.A)("download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);function g({clips:e}){let r=async e=>{try{c.oR.success(`Downloading ${e.title}...`)}catch(e){c.oR.error("Download failed. Please try again.")}};return 0===e.length?(0,n.jsxs)("div",{className:"flex min-h-[300px] flex-col items-center justify-center space-y-4 text-center",children:[(0,n.jsx)("div",{className:"text-6xl",children:"\uD83C\uDFAC"}),(0,n.jsx)("h3",{className:"text-xl font-semibold",children:"No clips yet"}),(0,n.jsx)("p",{className:"text-muted-foreground max-w-md",children:"Upload your first video to start generating viral clips automatically."})]}):(0,n.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:e.map(e=>(0,n.jsxs)(a.Zp,{children:[(0,n.jsx)(a.aR,{children:(0,n.jsxs)("div",{className:"flex items-start justify-between",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)(a.ZB,{className:"text-base",children:e.title}),(0,n.jsxs)(a.BT,{children:["Duration: ",Math.round(e.duration),"s"]})]}),(0,n.jsx)(m.E,{variant:"secondary",children:"Ready"})]})}),(0,n.jsx)(a.Wu,{children:(0,n.jsx)("div",{className:"aspect-video bg-muted rounded-md flex items-center justify-center",children:e.thumbnail?(0,n.jsx)("img",{src:e.thumbnail,alt:e.title,className:"w-full h-full object-cover rounded-md"}):(0,n.jsx)("div",{className:"text-muted-foreground text-sm",children:"No preview"})})}),(0,n.jsx)(a.wL,{className:"flex justify-between",children:(0,n.jsxs)(i.$,{onClick:()=>r(e),className:"btn-secondary btn-sm",children:[(0,n.jsx)(h,{className:"mr-1.5 h-4 w-4"}),"Download"]})})]},e.id))})}function y({clips:e,credits:r}){let[t,d]=(0,s.useState)([]),[p,m]=(0,s.useState)(!1),[h,y]=(0,s.useState)(!1),x=async()=>{if(0!==t.length){m(!0);try{c.oR.success("Files uploaded successfully!"),d([]);let e=document.querySelector('input[type="file"]');e&&(e.value="")}catch(e){c.oR.error("Upload failed. Please try again.")}finally{m(!1)}}},b=async()=>{y(!0);try{c.oR.success("Clips refreshed!")}catch(e){c.oR.error("Failed to refresh clips")}finally{y(!1)}};return r<=0?(0,n.jsxs)("div",{className:"flex min-h-[400px] flex-col items-center justify-center space-y-4 text-center",children:[(0,n.jsx)("div",{className:"text-6xl",children:"\uD83D\uDCB3"}),(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"No credits remaining"}),(0,n.jsx)("p",{className:"text-muted-foreground max-w-md",children:"You've used all your credits for this billing period. Purchase more credits to continue generating clips."}),(0,n.jsx)(f(),{href:"/dashboard/billing",children:(0,n.jsx)(i.$,{className:"btn-primary",children:"Buy Credits"})})]}):(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsxs)(a.Zp,{children:[(0,n.jsxs)(a.aR,{children:[(0,n.jsx)(a.ZB,{children:"Upload Videos"}),(0,n.jsxs)(a.BT,{children:["Upload your video files to generate clips. Each video costs 1 credit. You have ",r," credits remaining."]})]}),(0,n.jsxs)(a.Wu,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"grid w-full max-w-sm items-center gap-1.5",children:[(0,n.jsx)(l.J,{htmlFor:"video-upload",children:"Video files"}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(o.p,{id:"video-upload",type:"file",accept:"video/*",multiple:!0,onChange:e=>{e.target.files&&d(Array.from(e.target.files))},className:"hidden"}),(0,n.jsx)(l.J,{htmlFor:"video-upload",children:(0,n.jsx)(i.$,{className:"btn-secondary",type:"button",disabled:p,children:"Select File"})})]}),t.length>0&&(0,n.jsxs)("div",{className:"mt-2",children:[(0,n.jsxs)("p",{className:"text-sm text-muted-foreground",children:[t.length," file(s) selected:"]}),(0,n.jsx)("ul",{className:"text-sm",children:t.map((e,r)=>(0,n.jsx)("li",{children:e.name},r))})]})]}),(0,n.jsx)("div",{className:"flex space-x-2",children:(0,n.jsx)(i.$,{disabled:0===t.length||p,onClick:x,className:"btn-primary",children:p?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u,{className:"mr-2 h-4 w-4 animate-spin"}),"Uploading..."]}):"Upload and Generate Clips"})})]})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"Your Clips"}),(0,n.jsxs)(i.$,{onClick:b,disabled:h,className:"btn-secondary btn-sm",children:[h&&(0,n.jsx)(u,{className:"mr-2 h-4 w-4 animate-spin"}),"Refresh"]})]}),(0,n.jsx)(g,{clips:e})]})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},67218:(e,r,t)=>{"use strict";Object.defineProperty(r,"A",{enumerable:!0,get:function(){return n.registerServerReference}});let n=t(12907)},74722:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{normalizeAppPath:function(){return i},normalizeRscURL:function(){return a}});let n=t(85531),s=t(35499);function i(e){return(0,n.ensureLeadingSlash)(e.split("/").reduce((e,r,t,n)=>!r||(0,s.isGroupSegment)(r)||"@"===r[0]||("page"===r||"route"===r)&&t===n.length-1?e:e+"/"+r,""))}function a(e){return e.replace(/\.rsc($|\?)/,"$1")}},77598:e=>{"use strict";e.exports=require("node:crypto")},79130:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{decryptActionBoundArgs:function(){return h},encryptActionBoundArgs:function(){return m}}),t(34822);let n=t(12907),s=t(52513),i=t(77855),a=t(82602),o=t(63033),l=t(84971),c=function(e){return e&&e.__esModule?e:{default:e}}(t(61120)),d=new TextEncoder,u=new TextDecoder;async function p(e,r){let t=await (0,a.getActionEncryptionKey)();if(void 0===t)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let n=atob(r),s=n.slice(0,16),i=n.slice(16),o=u.decode(await (0,a.decrypt)(t,(0,a.stringToUint8Array)(s),(0,a.stringToUint8Array)(i)));if(!o.startsWith(e))throw Object.defineProperty(Error("Invalid Server Action payload: failed to decrypt."),"__NEXT_ERROR_CODE",{value:"E191",enumerable:!1,configurable:!0});return o.slice(e.length)}async function f(e,r){let t=await (0,a.getActionEncryptionKey)();if(void 0===t)throw Object.defineProperty(Error("Missing encryption key for Server Action. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E65",enumerable:!1,configurable:!0});let n=new Uint8Array(16);o.workUnitAsyncStorage.exit(()=>crypto.getRandomValues(n));let s=(0,a.arrayBufferToString)(n.buffer),i=await (0,a.encrypt)(t,n,d.encode(e+r));return btoa(s+(0,a.arrayBufferToString)(i))}let m=c.default.cache(async function e(r,...t){let{clientModules:s}=(0,a.getClientReferenceManifestForRsc)(),c=Error();Error.captureStackTrace(c,e);let d=!1,u=o.workUnitAsyncStorage.getStore(),p=(null==u?void 0:u.type)==="prerender"?(0,l.createHangingInputAbortSignal)(u):void 0,m=await (0,i.streamToString)((0,n.renderToReadableStream)(t,s,{signal:p,onError(e){(null==p||!p.aborted)&&(d||(d=!0,c.message=e instanceof Error?e.message:String(e)))}}),p);if(d)throw c;if(!u)return f(r,m);let h=(0,o.getPrerenderResumeDataCache)(u),g=(0,o.getRenderResumeDataCache)(u),y=r+m,x=(null==h?void 0:h.encryptedBoundArgs.get(y))??(null==g?void 0:g.encryptedBoundArgs.get(y));if(x)return x;let b="prerender"===u.type?u.cacheSignal:void 0;null==b||b.beginRead();let v=await f(r,m);return null==b||b.endRead(),null==h||h.encryptedBoundArgs.set(y,v),v});async function h(e,r){let t,n=await r,i=o.workUnitAsyncStorage.getStore();if(i){let r="prerender"===i.type?i.cacheSignal:void 0,s=(0,o.getPrerenderResumeDataCache)(i),a=(0,o.getRenderResumeDataCache)(i);(t=(null==s?void 0:s.decryptedBoundArgs.get(n))??(null==a?void 0:a.decryptedBoundArgs.get(n)))||(null==r||r.beginRead(),t=await p(e,n),null==r||r.endRead(),null==s||s.decryptedBoundArgs.set(n,t))}else t=await p(e,n);let{edgeRscModuleMapping:l,rscModuleMapping:c}=(0,a.getClientReferenceManifestForRsc)();return await (0,s.createFromReadableStream)(new ReadableStream({start(e){e.enqueue(d.encode(t)),(null==i?void 0:i.type)==="prerender"?i.renderSignal.aborted?e.close():i.renderSignal.addEventListener("abort",()=>e.close(),{once:!0}):e.close()}}),{serverConsumerManifest:{moduleLoading:null,moduleMap:c,serverModuleMap:(0,a.getServerModuleMap)()}})}},79646:e=>{"use strict";e.exports=require("child_process")},80559:(e,r,t)=>{"use strict";t.a(e,async(e,n)=>{try{t.r(r),t.d(r,{default:()=>p});var s=t(37413),i=t(67218);t(79130);var a=t(39916),o=t(43610),l=t(82310),c=t(13641),d=t(17478),u=e([l]);async function p(){let e=await (0,l.j2)();e?.user?.id||(0,a.redirect)("/login");let r=await c.db.user.findUniqueOrThrow({where:{id:e.user.id},select:{credits:!0,uploadedFiles:{where:{uploaded:!0},select:{id:!0,s3Key:!0,displayName:!0,status:!0,createdAt:!0,_count:{select:{clips:!0}}}},clips:{orderBy:{createdAt:"desc"}}}});r.uploadedFiles.map(e=>({id:e.id,s3Key:e.s3Key,filename:e.displayName??"Unkown filename",status:e.status,clipsCount:e._count.clips,createdAt:e.createdAt}));let t=r.clips.map(e=>({id:e.id,url:e.s3Key,title:`Clip ${e.id.slice(-6)}`,duration:30,thumbnail:void 0}));return(0,s.jsx)(o.DashboardClient,{clips:t,credits:r.credits})}l=(u.then?(await u)():u)[0],(0,d.D)([p]),(0,i.A)(p,"00d8e6fe7777699f20f80b3c37ed40207ea4ac6faa",null),n()}catch(e){n(e)}})},81630:e=>{"use strict";e.exports=require("http")},82602:(e,r,t)=>{"use strict";let n;Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{arrayBufferToString:function(){return o},decrypt:function(){return d},encrypt:function(){return c},getActionEncryptionKey:function(){return h},getClientReferenceManifestForRsc:function(){return m},getServerModuleMap:function(){return f},setReferenceManifestsSingleton:function(){return p},stringToUint8Array:function(){return l}});let s=t(71617),i=t(74722),a=t(29294);function o(e){let r=new Uint8Array(e),t=r.byteLength;if(t<65535)return String.fromCharCode.apply(null,r);let n="";for(let e=0;e<t;e++)n+=String.fromCharCode(r[e]);return n}function l(e){let r=e.length,t=new Uint8Array(r);for(let n=0;n<r;n++)t[n]=e.charCodeAt(n);return t}function c(e,r,t){return crypto.subtle.encrypt({name:"AES-GCM",iv:r},e,t)}function d(e,r,t){return crypto.subtle.decrypt({name:"AES-GCM",iv:r},e,t)}let u=Symbol.for("next.server.action-manifests");function p({page:e,clientReferenceManifest:r,serverActionsManifest:t,serverModuleMap:n}){var s;let a=null==(s=globalThis[u])?void 0:s.clientReferenceManifestsPerPage;globalThis[u]={clientReferenceManifestsPerPage:{...a,[(0,i.normalizeAppPath)(e)]:r},serverActionsManifest:t,serverModuleMap:n}}function f(){let e=globalThis[u];if(!e)throw Object.defineProperty(new s.InvariantError("Missing manifest for Server Actions."),"__NEXT_ERROR_CODE",{value:"E606",enumerable:!1,configurable:!0});return e.serverModuleMap}function m(){let e=globalThis[u];if(!e)throw Object.defineProperty(new s.InvariantError("Missing manifest for Server Actions."),"__NEXT_ERROR_CODE",{value:"E606",enumerable:!1,configurable:!0});let{clientReferenceManifestsPerPage:r}=e,t=a.workAsyncStorage.getStore();if(!t){var n=r;let e=Object.values(n),t={clientModules:{},edgeRscModuleMapping:{},rscModuleMapping:{}};for(let r of e)t.clientModules={...t.clientModules,...r.clientModules},t.edgeRscModuleMapping={...t.edgeRscModuleMapping,...r.edgeRscModuleMapping},t.rscModuleMapping={...t.rscModuleMapping,...r.rscModuleMapping};return t}let i=r[t.route];if(!i)throw Object.defineProperty(new s.InvariantError(`Missing Client Reference Manifest for ${t.route}.`),"__NEXT_ERROR_CODE",{value:"E570",enumerable:!1,configurable:!0});return i}async function h(){if(n)return n;let e=globalThis[u];if(!e)throw Object.defineProperty(new s.InvariantError("Missing manifest for Server Actions."),"__NEXT_ERROR_CODE",{value:"E606",enumerable:!1,configurable:!0});let r=process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY||e.serverActionsManifest.encryptionKey;if(void 0===r)throw Object.defineProperty(new s.InvariantError("Missing encryption key for Server Actions"),"__NEXT_ERROR_CODE",{value:"E571",enumerable:!1,configurable:!0});return n=await crypto.subtle.importKey("raw",l(atob(r)),"AES-GCM",!0,["encrypt","decrypt"])}},85531:(e,r)=>{"use strict";function t(e){return e.startsWith("/")?e:"/"+e}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ensureLeadingSlash",{enumerable:!0,get:function(){return t}})},87295:(e,r,t)=>{Promise.resolve().then(t.bind(t,61238))},90001:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var n=t(65239),s=t(48088),i=t(88170),a=t.n(i),o=t(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(r,l);let c={children:["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,80559)),"/app/src/app/dashboard/page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,63144)),"/app/src/app/dashboard/layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,16292)),"/app/src/app/dashboard/loading.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,94431)),"/app/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,67393)),"/app/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["/app/src/app/dashboard/page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},p=new n.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},94735:e=>{"use strict";e.exports=require("events")},96330:e=>{"use strict";e.exports=require("@prisma/client")},98435:e=>{"use strict";e.exports=import("@prisma/client/runtime/library")}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[719,19,190,469,298,530,327],()=>t(90001));module.exports=n})();